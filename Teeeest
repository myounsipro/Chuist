@ExtendWith(MockitoExtension.class)
class InvoiceWorkbookBuilderTest {

    InvoiceWorkbookBuilder workbookBuilder;

    @BeforeEach
    void setUp() {
        workbookBuilder = new InvoiceWorkbookBuilder();
    }

    @Test
    void shouldCreateWorkbookWithExpectedSheetAndContent() throws Exception {
        // GIVEN
        InvoiceLine mockLine = mock(InvoiceLine.class);
        List<InvoiceLine> invoiceLines = List.of(mockLine, mock(InvoiceLine.class));

        Invoice invoice = mock(Invoice.class);
        when(invoice.getInvoiceLines()).thenReturn(invoiceLines);

        InvoiceInfo invoiceInfo = mock(InvoiceInfo.class);
        when(invoiceInfo.invoice()).thenReturn(invoice);

        // WHEN
        Workbook workbook = workbookBuilder.createAndFillWorkbook(invoiceInfo);

        // THEN
        assertNotNull(workbook);
        Sheet sheet = workbook.getSheet("tatatat");
        assertNotNull(sheet);
        assertTrue(sheet.getPhysicalNumberOfRows() > 0, "Sheet should contain at least one row");
    }
}